<!doctype html>
<html lang="en">
	<head>
		<link rel="stylesheet" type="text/css" href="../article.css">
	</head> 
	<body>	
        <section class = "header">
            <h1>Result Processor</h1>
        </section>
        
		<section class = "article">            
             
            <p>One of the key steps in dPCR is determining the positive and negative partitions from the brightness fluorescence. To do this, the partitions need to be found and then the brightnesses thresholded into two groups. These counts can be used to determine concentration of targeted DNA in the sample.</p>

            <h3>Brainstorming</h3>
            <p> There were several methods that I considered using for the processor. Finding the maxima and image segmentation were the initial ideas, but the maxima method did not filter out dust, and the segmentation method was too slow to be useful. I tested the methods first in ImageJ and then moved to Jupyter to test the OpenCV functions.

            <h3>Current Method</h3>
            <p> I chose a variation of the image segmentation method for the result processor. Originally, the program was using watershed segmentation to find the partitions, then thresholding and finding the contours. This worked very well, but the brightness measurment was slow because every contour was creating a mask of the image. Changing this method to taking a slice of the image using a bounding rectangle of each contour drastically increased the speed.
            </p>

            <img src="result_processor/watershed/004_unknown.png" alt="Unknown" class="img">
            <br>

	        <img src="result_processor/contours/005_adj_contour.png" alt="Contour" class="img">

            <br>
            <img src="result_processor/contours/well_pixelmap.png" alt="Pixelmap" class="img">

            <h3>Results</h3>
            <p> The results of the algorithm are very accurate. The algorithm does not consider dust and is able to cut out unfilled partitions and noise well. Automatic thresholding seems to work when the partitions are roughly split into two brightness groups. The results are output as csv files using Pandas. Part of what helps the results is taking the brightness gradient from the LED to normalize the result images. The imaging module in the instrument does not have a flat brightness field, causing some areas to be repeatively brighter or darker. Normalizing the result images to this brightness gradient to create a "flat field" drastically improves the results.
            </p>
            <img src="result_processor/histogram.png" alt="Histograms" class="img">
            <img src="result_processor/output.png" alt="Output" class="img"> 

            <h3>Future plans</h3>
            <p> There are a few different avenues I want to consider.</p>
            <ul>
            <li> Change from python to C++ </li>
            <li> Rexamining the maxima method using C++ </li>
            <li> Removing non-randomness from the image </li>
            </ul>
            <p> Overall I am happy with the progress of the project and am excited to see what the outcome will be. </p>

        </section>
        
        
        <a class="normal_link" href="../formulatrix.html">
            <section class="footer">
                <h1>Return to Formulatrix</h1>
            </section>
        </a>
	</body>
</html>