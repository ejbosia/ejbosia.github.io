<!doctype html>
<html lang="en">
	<head>
		<link rel="stylesheet" type="text/css" href="../article.css">
        <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js?lang=c#&amp"></script>
	</head> 
	<body>	
        <section class = "header">
            <h1>Plate Poker</h1>
        </section>
        
		<section class = "article">            
            <img src="plate_poker/ui.PNG" alt="UI Image" class="img"> 
             
            <p> One of the production steps for making dPCR microplates is poking 0.5mm diameter holes in the plate. This was at the time the most time consuming part of the process, as each plate could require up to 192 holes to be poked. With the expected increase in production with the release of the Constellation, an automated system was desired to avoid having a production team poking plates.
             
            <p> <h3>Goals:</h3>
            <ul>
                <li>Handle 24 well and 96 well plate formats</li>
                <li>Poke 200 plates in a work shift</li>
                <li>Handle plates that are not uniform due to molding challenges</li>
            </ul>
                       
            <p> With the goals in mind, we decided the strategy of the poker was to use a mounted camera to locate the corner wells of the plate. Once the corners had been located, the rest of the locations could be interpolated or extrapolated under the assumption that the poking locations would be located linearly between the corners. The poker could then iterate through the map of locations and poke each hole.
            
            
            <p> <b>Instrument</b>
            <p> Instead of making a new instrument, we chose to retrofit an old imaging instrument. The instrument was already set up with a plate seat, two axis movement, a camera, and a full electronics board. I added a pneumatic cylinder with a needle to the end of the XY stage. My coworker helped with the machining of the bracket to hold the cylinder. I wired the solenoid controlling the pneumatics to a stepper driver on the board. Because the driver was current controlled, I could send a current to the solenoid to open it by moving the "stepper motor" one step.
            
            <p> <b>Program</b>
            <p> The software challenge of the instrument was moving the code from the old plate poker to the new instrument. The old instrument was controlled by CAN, and the new poker through our own control board. To get the motor control function to work, I took the code of our terminal program used for controlling our boards which was written in C#. I then cut out all of the functionality that was unneeded by the plate poker programs, and added code to run the poking operations.
            
            <pre class = "prettyprint">
//Pokes all holes
public void poke()
{
    Location temp;
    for (int i = 0; i < 12; i++)
    {
        for (int j = 0; j < 8; j++)
        {
            temp = grid_input[i, j].offset((double)config.global_x / 100, (double)config.global_y / 100);
            movement.move_xy(temp, 10000);
            for (int k = 0; k < config.poke_number; k++)
            {
                movement.poke(config.pokems, config.releasems);
            }
            if (background_operator.CancellationPending)
            {
                movement.light_off();
                return;
            }
        }

        for (int j = 7; j >= 0; j--)
        {
            temp = grid_output[i, j].offset((double)config.global_x/100, (double)config.global_y/100);
            movement.move_xy(temp, 10000);
            for (int k = 0; k < config.poke_number; k++)
            {
                movement.poke(config.pokems, config.releasems);
            }
            if (background_operator.CancellationPending)
            {
                movement.light_off();
                return;
            }
        }
    }

    mapped = false;
}</pre>

The program uses the <code class = "prettyprint">System.ComponentModel.BackgroundWorker()</code> component to maintain the UI while running the time-consuming movement functions. 
            
            <p> <b>Features:</b>
            <ul>
                <li>Dynamic location targeting of poking locations</li>
                <li>Ability to handle different plate types</li>
                <li>Ability to change locating positions</li>
                <li>Image based offset calibration</li>
                <li>XML configuration files</li>
                <li>Configuration file editing through the software</li>
                <li>Cancellation</li>
                <li>Realtime progress bar</li>
                <li>Ability to make custom poking locations (for fun mostly)</li>
            </ul>
            
            <p> <b>Outcome</b>
            
            <p> The final poking time was 90 seconds, brought down from 10 minutes when done manually. We currently have three of the poking instruments in production, and thousands of plates have been processed using the tool.</p> 
            
            
        </section>
      
        <a class="normal_link" href="../formulatrix.html">
            <section class="footer">
                <h1>Return to Formulatrix</h1>
            </section>
        </a>
	</body>
</html>